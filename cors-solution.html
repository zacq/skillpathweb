<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORS Solution for Skillpath.ai Webhook</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        h1, h2, h3 {
            color: #1a3c6e;
        }
        
        code {
            background-color: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: monospace;
        }
        
        .info-box {
            background-color: #e1f5fe;
            border-left: 4px solid #03a9f4;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .warning-box {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .solution-box {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        table, th, td {
            border: 1px solid #ddd;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #f2f2f2;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 15px;
            background-color: #00b3b0;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: #009a98;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CORS Solution for Skillpath.ai Webhook</h1>
        
        <div class="info-box">
            <p><strong>Current Implementation:</strong> We've implemented a client-side CORS proxy solution that attempts to use multiple public CORS proxies to route your webhook requests. This is a temporary solution for testing purposes.</p>
        </div>
        
        <h2>Understanding the CORS Issue</h2>
        
        <p>CORS (Cross-Origin Resource Sharing) is a security feature implemented by browsers that prevents web pages from making requests to a different domain than the one that served the web page. This is why you were seeing the "Network response was not ok" error when trying to send messages to the webhook.</p>
        
        <h2>Current Solution: Client-Side CORS Proxy</h2>
        
        <p>We've modified the chatbot.js file to use a series of public CORS proxies to route your webhook requests. The code will try multiple proxies in sequence until it finds one that works.</p>
        
        <div class="warning-box">
            <p><strong>Important:</strong> The current solution using public CORS proxies has several limitations:</p>
            <ul>
                <li>Public proxies may have rate limits or be unreliable</li>
                <li>Your data is being routed through third-party servers</li>
                <li>Not suitable for production use with sensitive data</li>
                <li>Some proxies may be blocked in certain regions or networks</li>
            </ul>
        </div>
        
        <h2>Recommended Long-Term Solutions</h2>
        
        <h3>Option 1: Configure CORS on the Webhook Server (Recommended)</h3>
        
        <p>The best solution is to configure the webhook server to allow CORS requests from your domain. This typically involves adding the appropriate CORS headers to the server's responses:</p>
        
        <pre>Access-Control-Allow-Origin: https://yourdomain.com
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: Content-Type
Access-Control-Allow-Credentials: true</pre>
        
        <p>Contact the webhook provider (n8n in this case) and ask them to enable CORS for your domain.</p>
        
        <h3>Option 2: Create Your Own Server-Side Proxy</h3>
        
        <p>If you can't modify the webhook server, create your own server-side proxy that forwards requests to the webhook. This eliminates CORS issues because your website and the proxy are on the same domain.</p>
        
        <p>Here's a simple example using Node.js and Express:</p>
        
        <pre>const express = require('express');
const axios = require('axios');
const app = express();

app.use(express.json());

app.post('/webhook-proxy', async (req, res) => {
  try {
    const response = await axios.post(
      'https://primary-production-3b968.up.railway.app/webhook-test/1ba9063c-4576-4874-9000-20d44594127f',
      req.body
    );
    res.json(response.data);
  } catch (error) {
    res.status(500).json({ error: 'Proxy error' });
  }
});

app.listen(3000, () => {
  console.log('Proxy server running on port 3000');
});</pre>
        
        <p>Then update your chatbot to use your proxy endpoint instead of the direct webhook URL:</p>
        
        <pre>webhookUrl: '/webhook-proxy'</pre>
        
        <h3>Option 3: Use a Serverless Function</h3>
        
        <p>Deploy a serverless function (AWS Lambda, Vercel Functions, Netlify Functions, etc.) that acts as a proxy. This is similar to Option 2 but doesn't require maintaining a server.</p>
        
        <h2>Testing the Current Implementation</h2>
        
        <p>You can test the current CORS proxy implementation by using the chatbot on your website. The chatbot will automatically try multiple CORS proxies to find one that works.</p>
        
        <p>If you encounter any issues, check the browser console for detailed error messages that can help identify the problem.</p>
        
        <a href="index.html" class="btn">Go to Homepage</a>
        <a href="webhook-diagnostics.html" class="btn">Open Diagnostics Tool</a>
    </div>
</body>
</html>
